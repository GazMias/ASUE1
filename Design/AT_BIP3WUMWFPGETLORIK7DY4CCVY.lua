-- 16 bit BCD to decimal conversion
function BCD_to_dec(BCD)
    local result = 0
    result = result + ((BCD >> 12) & 0x0f)*1000
    result = result + ((BCD >> 8)  & 0x0f)*100
    result = result + ((BCD >> 4)  & 0x0f)*10
    result = result + ( BCD        & 0x0f)*1
    return result
end
--16 битная конвртация из десятичной в двоичнодесятичную систему
function DEC_to_BCD(DEC)
    local result = 0
    result=(math.floor (DEC/1000)<<12)+((math.floor (DEC/100)%10)<<8)+((math.floor (DEC/10)%10)<<4)+(math.floor (DEC)%10)
    return result
end
--Таблица знаков
char_table={
[0]="?",[1]="?",[2]="?",[3]="?",[4]="?",[5]="?",[6]="?",[7]="?",[8]="?",[9]="?",[10]="?",[11]="?",[12]="?",[13]="?",[14]="?",[15]="?",[16]="?",[17]="?",[18]="?",[19]="?",[20]="?",[21]="?",[22]="?",
[23]="?",[24]="?",[25]="?",[26]="?",[27]="?",[28]="?",[29]="?",[30]="?",[31]="?",[32]=" ",[33]="!",[34]='"',
[35]="#",[36]="$",[37]="%",[38]="&",[39]="'",[40]="(",[41]=")",[42]="*",[43]="+",[44]=",",[45]="-",[46]=".",[47]="/",[48]="0",[49]="1",[50]="2",[51]="3",[52]="4",[53]="5",
[54]="6",[55]="7",[56]="8",[57]="9",[58]=":",[59]=";",[60]="<",[61]="=",[62]=">",[63]="?",[64]="@",[65]="?",[66]="?",[67]="?",[68]="?",[69]="?",[70]="?",[71]="?",
[72]="?",[73]="?",[74]="?",[75]="?",[76]="?",[77]="?",[78]="?",[79]="?",[80]="?",[81]="?",[82]="?",[83]="?",[84]="?",[85]="?",[86]="?",[87]="?",[88]="?",[89]="?",[90]="?",
[91]="?",[92]="?",[93]="?",[94]="^",[95]="_",[96]="`",[97]="?",[98]="?",[99]="?",[100]="?",[101]="?",[102]="?",[103]="?",[104]="?",[105]="?",[106]="?",[107]="?",[108]="?",
[109]="?",[110]="?",[111]="?",[112]="?",[113]="?",[114]="?",[115]="?",[116]="?",[117]="?",[118]="?",[119]="?",[120]="?",[121]="?",[122]="?",[123]="{",[124]="|",[125]="}",
[126]="~",[127]="?",[128]="А",[129]="Б",[130]="В",[131]="Г",[132]="Д",[133]="Е",[134]="Ж",[135]="З",[136]="И",[137]="Й",[138]="К",[139]="Л",[140]="М",[141]="Н",[142]="О",
[143]="П",[144]="Р",[145]="С",[146]="Т",[147]="У",[148]="Ф",[149]="Х",[150]="Ц",[151]="Ч",[152]="Ш",[153]="Щ",[154]="Ъ",[155]="Ы",[156]="Ь",[157]="Э",[158]="Ю",
[159]="Я",[160]="а",[161]="б",[162]="в",[163]="г",[164]="д",[165]="е",[166]="ж",[167]="з",[168]="и",[169]="й",[170]="к",[171]="л",[172]="м",[173]="н",[174]="о",[175]="п",
[176]="?",[177]="?",[178]="?",[179]="?",[180]="?",[181]="?",[182]="?",[183]="?",[184]="?",[185]="?",[186]="?",[187]="?",[188]="?",[189]="?",[190]="?",[191]="?",[192]="?",
[193]="?",[194]="?",[195]="?",[196]="?",[197]="?",[198]="?",[199]="?",[200]="?",[201]="?",[202]="?",[203]="?",[204]="?",[205]="?",[206]="?",[207]="?",[208]="?",[209]="?",
[210]="?",[211]="?",[212]="?",[213]="?",[214]="?",[215]="?",[216]="?",[217]="?",[218]="?",[219]="?",[220]="?",[221]="?",[222]="?",[223]="?",[224]="р",[225]="с",[226]="т",
[227]="у",[228]="ф",[229]="х",[230]="ц",[231]="ч",[232]="ш",[233]="щ",[234]="ъ",[235]="ы",[236]="ь",[237]="э",[238]="ю",[239]="я",[240]="?",[241]="?",[242]="?",
[243]="?",[244]="?",[245]="?",[246]="?",[247]="?",[248]="?",[249]="?",[250]="?",[251]="?",[252]="?",[253]="?",[254]="?",[255]="?"

}